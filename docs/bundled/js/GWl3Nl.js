import{c as e,o as t,a as n,i as s,b as i,t as a,u as r,d as o,e as l,f as c,g as d,h as g,s as u,F as h,l as v,j as m,k as p,m as y,n as f,S as w}from"./main.js";var x=a("<div class=cursor><div class=cursorInner>");function I(a){let r;const[o,l]=e({x:0,y:0}),c=e=>{const{clientX:t,clientY:n}=e;l({x:t,y:n})};return t((()=>{r=new AbortController;const e=r.signal;window.addEventListener("mousemove",c,{passive:!0,signal:e})})),n((()=>{null==r||r.abort()})),g=(d=x()).firstChild,s(g,(()=>a.cursorText())),i((e=>{var t=!!a.active(),n=`translate3d(${o().x}px, ${o().y}px, 0)`;return t!==e.e&&d.classList.toggle("active",e.e=t),n!==e.t&&(null!=(e.t=n)?d.style.setProperty("transform",n):d.style.removeProperty("transform")),e}),{e:void 0,t:void 0}),d;var d,g}const E=document.getElementsByClassName("threshold")[0],A=Array.from(E.getElementsByClassName("num")),T=E.getElementsByClassName("dec").item(0),H=E.getElementsByClassName("inc").item(0),L=document.getElementsByClassName("index").item(0),O=Array.from(L.getElementsByClassName("num"));function b(){const[e,{incThreshold:t,decThreshold:n}]=r();return o((()=>{var t,n,s;t=l(e().index+1),n=l(e().length),O.forEach(((e,s)=>{e.innerText=s<4?t[s]:n[s-4]})),s=l(e().threshold),A.forEach(((e,t)=>{e.innerText=s[t]}))})),T.onclick=n,H.onclick=t,null}var C=a("<div class=stage>"),N=a("<img>");function k(e){return e.map((e=>e.i))}function U(e,t){return function(e,t){return k(e).slice(-t.trailLength)}(e,t).slice(0,-1)}function V(e){return k(e).slice(-1)[0]}function j(e,t){return m(e.slice(-1)[0].i,t.length)}function W(e,t){return p(e.slice(-1)[0].i,t.length)}function B(e,t){return t.map((t=>e[t]))}function $(e){e.forEach((e=>{e.src!==e.dataset.hiUrl&&(e.src=e.dataset.hiUrl,e.height=parseInt(e.dataset.hiImgH),e.width=parseInt(e.dataset.hiImgW))}))}function M(e){e.forEach((e=>{e.src!==e.dataset.loUrl&&(e.src=e.dataset.loUrl,e.height=parseInt(e.dataset.loImgH),e.width=parseInt(e.dataset.loImgW))}))}function F(e){let n;const a=Array(e.ijs.length);let l,m={x:0,y:0},p=!1;const[y,{incIndex:f}]=r(),w=y().length;let x=!1;const I=t=>{if(e.isOpen()||e.isAnimating()||!p||!x)return;const n={x:t.clientX,y:t.clientY};if(Math.hypot(n.x-m.x,n.y-m.y)>y().threshold){m=n,f();const t={i:y().index,...n};e.setCordHist((e=>[...e,t].slice(-w)))}};function E(t){if(x&&p)if(t.complete)n.set(t,{opacity:1}).then((()=>{e.setIsLoading(!1)})).catch((e=>{console.log(e)}));else{e.setIsLoading(!0);const s=new AbortController,i=s.signal;t.addEventListener("load",(()=>{n.to(t,{opacity:1,ease:"power3.out",duration:.5}).then((()=>{e.setIsLoading(!1)})).catch((e=>{console.log(e)})).finally((()=>{s.abort()}))}),{once:!0,passive:!0,signal:i}),t.addEventListener("error",(()=>{n.set(t,{opacity:1}).then((()=>{e.setIsLoading(!1)})).catch((e=>{console.log(e)})).finally((()=>{s.abort()}))}),{once:!0,passive:!0,signal:i})}}return t((()=>{a.forEach(((t,n)=>{n<5&&(t.src=t.dataset.loUrl),function(e,t,n={attributes:!0}){new MutationObserver(((e,n)=>{for(const s of e)if(t(s)){n.disconnect();break}})).observe(e,n)}(t,(s=>!e.isOpen()&&!e.isAnimating()&&"style"===s.attributeName&&1===parseFloat(t.style.opacity)&&(n+5<a.length&&(a[n+5].src=a[n+5].dataset.loUrl),!0)))})),window.addEventListener("mousemove",(()=>{v().then((e=>{n=e,p=!0})).catch((e=>{console.log(e)}))}),{passive:!0,once:!0}),l=new AbortController;const t=l.signal;window.addEventListener("mousemove",I,{passive:!0,signal:t}),x=!0})),o(c((()=>e.cordHist()),(()=>{(()=>{if(!x)return;if(0===a.length)return;const t=e.cordHist(),s=k(t);if(0===s.length)return;const i=B(a,s),r=e.isOpen(),o=y();if(n.set(i,{x:e=>t[e].x-window.innerWidth/2,y:e=>t[e].y-window.innerHeight/2,opacity:e=>Math.max((e+1+o.trailLength<=t.length?0:1)-(r?1:0),0),zIndex:e=>e,scale:.6}),r){const s=B(a,[V(t)])[0],i=[],r=[];switch(e.navVector()){case"prev":i.push(j(t,o)),r.push(W(t,o));break;case"next":i.push(W(t,o)),r.push(j(t,o))}$(B(a,i)),n.set(B(a,r),{opacity:0}),n.set(s,{x:0,y:0,scale:1}),E(s)}else M(i)})()}),{defer:!0})),o(c((()=>e.isOpen()),(async()=>{e.isAnimating()||(e.isOpen()?await(async()=>{if(!x||!p)throw new Error("not mounted or gsap not loaded");e.setIsAnimating(!0);const t=e.cordHist(),s=y(),i=V(t),r=a[i];$(B(a,[i,j(t,s),W(t,s)])),E(r);const o=n.timeline(),l=B(a,U(t,s));return o.to(l,{y:"+=20",ease:"power3.in",stagger:.075,duration:.3,delay:.1,opacity:0}),o.to(r,{x:0,y:0,ease:"power3.inOut",duration:.7,delay:.3}),o.to(r,{delay:.1,scale:1,ease:"power3.inOut"}),await o.then((()=>{e.setIsAnimating(!1)}))})().catch((()=>{})).then((()=>{null==l||l.abort()})):await(async()=>{if(!x||!p)throw new Error("not mounted or gsap not loaded");e.setIsAnimating(!0),e.setNavVector("none");const t=e.cordHist(),s=y(),i=V(t),r=U(t,s);M(B(a,[...r,i]));const o=n.timeline(),l=B(a,[i])[0],c=B(a,r);return o.to(l,{scale:.6,duration:.6,ease:"power3.inOut"}),o.to(l,{delay:.3,duration:.7,ease:"power3.inOut",x:t.slice(-1)[0].x-window.innerWidth/2,y:t.slice(-1)[0].y-window.innerHeight/2}),o.to(c,{y:"-=20",ease:"power3.out",stagger:-.1,duration:.3,opacity:1}),await o.then((()=>{e.setIsAnimating(!1)}))})().catch((()=>{})).then((()=>{l=new AbortController;const t=l.signal;window.addEventListener("mousemove",I,{passive:!0,signal:t}),e.setIsLoading(!1)})))}),{defer:!0})),A=C(),s(A,d(h,{get each(){return e.ijs},children:(e,t)=>{return n=N(),"function"==typeof(s=a[t()])?g(s,n):a[t()]=n,i((t=>{var s=e.loImgH,i=e.loImgW,a=e.hiUrl,r=e.hiImgH,o=e.hiImgW,l=e.loUrl,c=e.loImgH,d=e.loImgW,g=e.alt;return s!==t.e&&u(n,"height",t.e=s),i!==t.t&&u(n,"width",t.t=i),a!==t.a&&u(n,"data-hi-url",t.a=a),r!==t.o&&u(n,"data-hi-img-h",t.o=r),o!==t.i&&u(n,"data-hi-img-w",t.i=o),l!==t.n&&u(n,"data-lo-url",t.n=l),c!==t.s&&u(n,"data-lo-img-h",t.s=c),d!==t.h&&u(n,"data-lo-img-w",t.h=d),g!==t.r&&u(n,"alt",t.r=g),t}),{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),n;var n,s}})),A;var A}var P=a("<div class=navOverlay>"),X=a("<div class=overlay tabindex=-1>");function Y(e){let t;const n=[e.prevText,e.closeText,e.nextText],[a,{incIndex:l,decIndex:c}]=r(),g=a().length,u=t=>{e.isOpen()&&!e.isAnimating()&&("ArrowLeft"===t.key?(e.setNavVector("prev"),e.setCordHist((e=>e.map((e=>({...e,i:m(e.i,g)}))))),c()):"Escape"===t.key?e.setIsOpen(!1):"ArrowRight"===t.key&&(e.setNavVector("next"),e.setCordHist((e=>e.map((e=>({...e,i:p(e.i,g)}))))),l()))};return o((()=>{if(e.isOpen()){t=new AbortController;const e=t.signal;window.addEventListener("keydown",u,{passive:!0,signal:e})}else null==t||t.abort()})),v=P(),s(v,d(h,{each:n,children:t=>{return(n=X()).$$mouseover=()=>e.setHoverText(t),n.addEventListener("focus",(()=>e.setHoverText(t))),n;var n}})),i((()=>v.classList.toggle("active",!!e.active()))),v;var v}function z(t){const[n,s]=e([]),[i,a]=e(!1),[r,o]=e(!1),[l,c]=e(!1),[g,u]=e(""),[h,v]=e("none"),m=f((()=>r()&&!l())),p=f((()=>i()?t.loadingText:g()));return[d(b,{}),d(w,{get when(){return t.ijs.length>0},get children(){return[d(F,{get ijs(){return t.ijs},setIsLoading:a,isOpen:r,setIsOpen:o,isAnimating:l,setIsAnimating:c,cordHist:n,setCordHist:s,navVector:h,setNavVector:v}),d(w,{get when(){return r()},get children(){return[d(I,{cursorText:p,active:m,isOpen:r}),d(Y,{get prevText(){return t.prevText},get closeText(){return t.closeText},get nextText(){return t.nextText},get loadingText(){return t.loadingText},active:m,isAnimating:l,setCordHist:s,isOpen:r,setIsOpen:o,setHoverText:u,navVector:h,setNavVector:v})]}})]}})]}y(["mouseover"]);export{z as default};